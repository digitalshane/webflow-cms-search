"use strict";(()=>{(function(){let u=null,s=null;function b(e,t){let n;return function(...r){clearTimeout(n),n=setTimeout(()=>e.apply(this,r),t)}}async function p(e){return u||s||(s=(async()=>{try{let t=new URL(e.apiPath,e.apiUrl);t.searchParams.set("collections",e.collections);let n=await fetch(t.toString());if(!n.ok)throw new Error(`Data fetch failed: ${n.status}`);return u=(await n.json()).items,u}catch(t){return console.error("Webflow Search: Failed to load data:",t),s=null,[]}})(),s)}function D(e,t){if(!t.trim())return[];let n=t.toLowerCase();return e.filter(r=>r.searchText.includes(n)).map(r=>({id:r.id,name:r.name,slug:r.slug,collectionId:r.collectionId,collectionSlug:r.collectionSlug,fieldData:r.fieldData}))}function S(){let e=document.querySelector('[data-tag="search"]'),t=document.querySelector('[data-tag="results"]'),n=document.querySelector('[data-tag="results-item"]');if(!e){console.warn("Webflow Search: No element with data-tag='search' found");return}if(!t){console.warn("Webflow Search: No element with data-tag='results' found");return}if(!n){console.warn("Webflow Search: No element with data-tag='results-item' found");return}let r=e.getAttribute("data-api-url")||window.location.origin,E=e.getAttribute("data-api-path")||"/app/api/data",y=e.getAttribute("data-collections")||"all",I=parseInt(e.getAttribute("data-debounce")||"100",10);n.style.display="none";let g={apiUrl:r,apiPath:E,collections:y,debounceMs:I};p(g);async function w(o){if(!o.trim()){m();return}try{let a=await p(g),i=D(a,o);A(i)}catch(a){console.error("Webflow Search error:",a),m()}}function m(){if(!t||!n)return;Array.from(t.children).forEach(a=>{a!==n&&a.remove()})}function A(o){!t||!n||(m(),o.length!==0&&o.forEach(a=>{let i=n.cloneNode(!0);i.style.display="",i.removeAttribute("data-tag");let d=i.querySelector('[data-tag="results-title"]');d&&(d.textContent=a.name);let f=i.querySelector('[data-tag="results-link"]');f&&(f.href=`/${a.slug}`,(!d||f===d)&&(f.textContent=a.name)),i.querySelectorAll("[data-field]").forEach(l=>{let c=l.getAttribute("data-field");if(c&&a.fieldData[c]!==void 0){let h=a.fieldData[c];l instanceof HTMLAnchorElement&&c.includes("url")?l.href=String(h):l instanceof HTMLImageElement&&c.includes("image")?l.src=String(h):l.textContent=String(h)}}),t.appendChild(i)}))}let L=b(o=>w(o),g.debounceMs);e.addEventListener("input",o=>{let a=o.target;L(a.value)});let T=e.closest("form");T&&T.addEventListener("submit",o=>{o.preventDefault(),w(e.value)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):S()})();})();
